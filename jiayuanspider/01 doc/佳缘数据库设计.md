# 佳缘数据库设计

## 数据库选型

SQLite 3 `一种开源，零配置，独立的，独立的，事务关系数据库引擎`

SQLite 的安装配置

1. 获取程序文件：sqlite3.dll sqlite3.exe sqlite3.def
2. 注册环境变量
3. 可从cmd访问

SQLite 的基本操作

- 库与表
  - 创建数据库

```sql lite
  cd your_dir sqlite3.exe db_name.db
```

  - 创建表

  ```sql lite
  CREATE TABLE database_name.table_name(  
     column1 datatype  PRIMARY KEY(one or more columns),  
     column2 datatype,  
     column3 datatype,  
     .....  
     columnN datatype,  
  );
  ```

  - 修改表

```sql lite
ALTER TABLE database_name.table_name RENAME TO new_table_name;
```

  - 删除表

  ```sql lite
  DROP TABLE database_name.table_name;
  ```

- CURD操作

  - 插入查询

    ```sql lite
    INSERT INTO TABLE_NAME [(column1, column2, column3,...columnN)]    
    VALUES (value1, value2, value3,...valueN);
    ```

  - 选择查询

    ```sql lite
    SELECT column1, column2, columnN FROM table_name;
    ```

  - 更新查询

    ```sql lite
    UPDATE table_name  
    SET column1 = value1, column2 = value2...., columnN = valueN  
    WHERE [condition];
    ```

  - 删除查询

    ```sql lite
    DELETE FROM table_name  
    WHERE [conditions....................];;
    ```

- 日期与时间

  - date() ` return YYYY-MM-DD`

    ```sql lite
    date(timestring, [ modifier1, modifier2, ... modifier_n ] )
    date('now')
    ```

  - datetime() `return YYYY-MM-DD HH:MM:SS`

    ```sql lite
    datetime(timestring, [ modifier1, modifier2, ... modifier_n ] )
    ```

  - julianday() `return days after julian day`

    ```sql lite
    julianday(timestring [, modifier1, modifier2, ... modifier_n ] )
    ```

  - time() `return HH:MM:SS`

    ```sql lite
    time(timestring, [ modifier1, modifier2, ... modifier_n ] )
    ```

- SQLite 主键

  SQLite主键是用于唯一定义行记录的一个简单字段或多个字段的组合。一个表只能有一个主键。

  主键的值不可以是一个`NULL`值。

  主键通常在创建表时一同创建。在执行`CREATE TABLE`语句时可以直接定义主键。例如：创建一个“`workers`”表，其中`worker_id`列是表的主键。

- 导入数据

  - 从CSV文件导入

    ```sql lite
    .mode csv  //声明为CSV文件
    .import D:/software/sqlite/data.csv employee
    ```

- 导出数据

  - 导出为CSV文件

    ```sql lite
    .header on  
    .mode csv  
    .once D:/software/sqlite/student.csv  
    SELECT * FROM student;
    ```

## Python 连接 SQLite 数据库

` 要使用sqlite3模块，必须首先创建一个表示数据库的连接对象，然后可以选择创建的游标对象来执行SQL语句。`

- 连接数据库

  以下Python代码显示了如何连接到一个指定的数据库。 如果数据库不存在，那么它将被创建，最后将返回一个数据库对象。

  ```python
  import sqlite3

  conn = sqlite3.connect('pydb.db')
  ```

- 创建表

  ```python
  ## 创建一个表 - company
  conn.execute('''CREATE TABLE company
         (ID INT PRIMARY KEY     NOT NULL,
         NAME           TEXT    NOT NULL,
         AGE            INT     NOT NULL,
         ADDRESS        CHAR(50),
         SALARY         REAL);''')
  conn.close()
  ```

- 插入操作

  ```python
  conn.execute("INSERT INTO COMPANY (ID,NAME,AGE,ADDRESS,SALARY) \
        VALUES (1, 'Maxsu', 27, 'Haikou', 20000.00 )");
  ```

- 查询操作

  ```python
  cursor = conn.execute("SELECT id, name, address, salary  from COMPANY")
  for row in cursor:
     print ("ID = ", row[0])
     print ("NAME = ", row[1])
     print ("ADDRESS = ", row[2])
     print ("SALARY = ", row[3], "\n")
  ```

- 更新操作

  ```python
  conn.execute("UPDATE COMPANY set SALARY = 29999.00 where ID=1")
  ```

- 删除操作

  ```python
  conn.execute("DELETE from COMPANY where ID<=2;")
  ```


## 佳缘数据库设计

根据返回的json数据,设计数据库如下：

|    键名    |  数据类型   |      主键       |    举例     |
| :------: | :-----: | :-----------: | :-------: |
|    ID    | INTEGER | AUTOINCREMENT |   NULL    |
|   UID    |   INT   |  PRIMARY KEY  | 123456789 |
| NICKNAME |  TEXT   |   NOT NULL    |   super   |
|   AGE    |   INT   |   NOT NULL    |    23     |
|  HEIGHT  |   INT   |   NOT NULL    |    175    |
|          |         |               |           |
|          |         |               |           |
|          |         |               |           |
|          |         |               |           |